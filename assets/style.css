@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

/* ===============================
   Design Tokens
================================ */
:root {
    /* Color system */
    --color-bg-canvas: #0b0f15;
    --color-surface-1: #111722;
    --color-surface-2: #141c28;
    --color-surface-3: #182131;
    --color-surface-interactive: #0f151f;

    --color-border-subtle: #273245;
    --color-border-strong: #34445d;

    --color-text-primary: #edf2f8;
    --color-text-secondary: #bcc7d6;
    --color-text-tertiary: #93a1b5;

    --color-accent-primary: #FF1801;
    --color-accent-secondary: #00d97e;
    --color-warning: #ffb020;
    --color-sector-purple: #b56cff;

    --color-telemetry-1: #FF1801;
    --color-telemetry-2: #00d2be;
    --color-telemetry-3: #4da3ff;
    --color-telemetry-4: #ffc857;
    --color-telemetry-5: #f78c6b;
    --color-telemetry-6: #9b8cff;

    /* Legacy aliases */
    --bg-main: var(--color-bg-canvas);
    --bg-card: var(--color-surface-2);
    --bg-dropdown: var(--color-surface-interactive);
    --border: var(--color-border-subtle);
    --font-primary: var(--color-text-primary);
    --font-muted: var(--color-text-tertiary);
    --accent-red: var(--color-accent-primary);

    /* Spacing scale */
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 24px;
    --space-6: 32px;
    --space-7: 40px;
    --space-8: 56px;

    /* Radius scale */
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 20px;

    /* Elevation */
    --shadow-card: 0 8px 22px rgba(0, 0, 0, 0.24);
    --shadow-card-hover: 0 14px 30px rgba(0, 0, 0, 0.3);
    --shadow-toolbar: 0 6px 18px rgba(0, 0, 0, 0.26);

    /* Motion */
    --motion-fast: 150ms;
    --motion-base: 180ms;
    --motion-ease: cubic-bezier(0.22, 0.61, 0.36, 1);

    /* Layout */
    --topbar-height: 164px;
    --container-max: 1560px;
}

/* ===============================
   Base
================================ */
* {
    box-sizing: border-box;
}

html,
body {
    margin: 0 !important;
    padding: 0 !important;
}

body {
    background: var(--color-bg-canvas) !important;
    color: var(--color-text-primary) !important;
    font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif !important;
    -webkit-font-smoothing: antialiased;
    text-rendering: geometricPrecision;
}

.main_container {
    width: min(var(--container-max), 100%);
    margin: 0 auto;
}

/* ===============================
   Top Header Bar
================================ */
.dashboard-topbar {
    position: fixed;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: min(var(--container-max), 100%);
    height: var(--topbar-height);
    display: grid;
    grid-template-columns: minmax(280px, 1.15fr) minmax(540px, 1.85fr);
    gap: var(--space-5);
    align-items: stretch;
    padding: var(--space-4) var(--space-5);
    border-bottom: 1px solid var(--color-border-subtle);
    background: var(--color-surface-1);
    box-shadow: var(--shadow-toolbar);
    z-index: 1000;
}

.toolbar-left {
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-width: 0;
}

.app-badge {
    display: inline-flex;
    width: fit-content;
    margin-bottom: var(--space-2);
    padding: var(--space-1) var(--space-3);
    border-radius: 999px;
    border: 1px solid rgba(255, 24, 1, 0.36);
    background: rgba(255, 24, 1, 0.08);
    color: #ff9388;
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
}

.dashboard-title {
    margin: 0;
    color: var(--color-text-primary);
    font-size: 1.55rem;
    line-height: 1.2;
    font-weight: 700;
    letter-spacing: 0.01em;
}

.dashboard-subtitle {
    margin: var(--space-2) 0 0;
    color: var(--color-text-secondary);
    font-size: 0.88rem;
    line-height: 1.45;
}

.toolbar-meta {
    margin: var(--space-2) 0 0;
    color: var(--color-text-tertiary);
    font-size: 0.76rem;
    line-height: 1.35;
    letter-spacing: 0.02em;
}

.toolbar-right {
    min-width: 0;
    display: flex;
    align-items: center;
}

/* ===============================
   Control Grid
================================ */
.control-bar {
    width: 100%;
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1.8fr;
    gap: var(--space-3);
    align-items: end;
    padding: var(--space-4);
    border: 1px solid var(--color-border-subtle);
    border-radius: var(--radius-lg);
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.012), rgba(255, 255, 255, 0)), var(--color-surface-2);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.03);
}

.control-field,
.control-field--wide {
    min-width: 0;
}

.control-label {
    display: block;
    margin-bottom: var(--space-2);
    color: var(--color-text-tertiary);
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
}

.f1-dropdown,
.f1-dropdown .Select-control,
.f1-dropdown .Select-placeholder {
    min-height: 40px;
}

/* ===============================
   Main Content Wrapper
================================ */
.dashboard-content {
    padding: calc(var(--topbar-height) + var(--space-5)) var(--space-5) var(--space-7);
}

.tab-body {
    display: block;
}

.performance-view,
.session-view {
    display: grid;
    gap: var(--space-5);
}

.summary-grid,
.session-bottom-grid {
    display: grid;
    grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
    gap: var(--space-5);
}

/* ===============================
   Tabs Navigation
================================ */
.custom-tabs-container {
    margin-bottom: var(--space-5);
    padding: 0;
    border-bottom: 1px solid var(--color-border-subtle);
    background: transparent !important;
}

.custom-tabs {
    border: none !important;
    background: transparent !important;
}

.custom-tab {
    position: relative;
    margin-right: var(--space-5) !important;
    padding: var(--space-2) 0 var(--space-3) !important;
    border: none !important;
    background: transparent !important;
    color: var(--color-text-tertiary) !important;
    font-size: 0.89rem;
    font-weight: 500;
    letter-spacing: 0.02em;
    transition:
        color var(--motion-fast) var(--motion-ease),
        opacity var(--motion-fast) var(--motion-ease);
}

.custom-tab::after {
    content: "";
    position: absolute;
    left: 0;
    right: 0;
    bottom: -1px;
    height: 2px;
    border-radius: 999px;
    background: transparent;
    transform: scaleX(0.25);
    transform-origin: center;
    transition:
        transform var(--motion-base) var(--motion-ease),
        background-color var(--motion-base) var(--motion-ease);
}

.custom-tab:hover {
    color: var(--color-text-secondary) !important;
}

.custom-tab--selected {
    color: var(--color-text-primary) !important;
}

.custom-tab--selected::after {
    background: var(--color-accent-primary);
    transform: scaleX(1);
}

/* ===============================
   Section Cards
================================ */
.section-card {
    position: relative;
    padding: var(--space-4);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-border-subtle) !important;
    background:
        linear-gradient(180deg, rgba(255, 255, 255, 0.012), rgba(255, 255, 255, 0)) ,
        var(--color-surface-2) !important;
    box-shadow:
        var(--shadow-card),
        inset 0 1px 0 rgba(255, 255, 255, 0.024),
        inset 0 -1px 0 rgba(0, 0, 0, 0.24);
    transition:
        transform var(--motion-fast) ease,
        box-shadow var(--motion-fast) ease,
        border-color var(--motion-fast) var(--motion-ease);
}

.section-card::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    border: 1px solid rgba(255, 255, 255, 0.018);
    pointer-events: none;
}

.section-card:hover {
    transform: translateY(-3px);
    border-color: rgba(255, 24, 1, 0.36) !important;
    box-shadow:
        var(--shadow-card-hover),
        0 0 0 1px rgba(255, 24, 1, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.03);
}

.section-header {
    margin-bottom: var(--space-4);
}

.section-kicker {
    margin-bottom: var(--space-1);
    color: var(--color-text-tertiary);
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
}

.section-heading {
    margin: 0;
    color: var(--color-text-primary);
    font-size: 1.06rem;
    font-weight: 600;
    letter-spacing: 0.01em;
    line-height: 1.28;
}

.section-subtitle {
    margin: var(--space-2) 0 0;
    color: var(--color-text-tertiary);
    font-size: 0.84rem;
    line-height: 1.4;
}

.metric-grid {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.metric-card {
    padding: var(--space-3);
    border-radius: var(--radius-md);
    border: 1px solid rgba(255, 255, 255, 0.05);
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.005));
    min-height: 96px;
}

.metric-card-title {
    color: var(--color-text-tertiary);
    font-size: 10px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    font-weight: 600;
}

.metric-card-value {
    margin-top: var(--space-2);
    color: var(--color-text-primary);
    font-size: 1.25rem;
    font-weight: 700;
    line-height: 1.2;
    font-variant-numeric: tabular-nums;
}

.metric-card-detail {
    margin-top: var(--space-2);
    color: var(--color-text-tertiary);
    font-size: 0.77rem;
    line-height: 1.35;
}

.delta-grid {
    display: grid;
    grid-template-columns: minmax(0, 2.1fr) minmax(300px, 0.9fr);
    gap: var(--space-4);
}

.delta-grid-main,
.delta-grid-side {
    min-width: 0;
}

/* ===============================
   Telemetry + Mini Track
================================ */
.telemetry-grid {
    display: grid;
    grid-template-columns: minmax(0, 2.85fr) minmax(220px, 0.9fr);
    gap: var(--space-4);
    align-items: start;
}

.telemetry-main,
.telemetry-mini {
    min-width: 0;
}

.mini-track-companion {
    position: sticky;
    top: calc(var(--topbar-height) + var(--space-5));
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border-subtle);
    background: var(--color-surface-3);
    padding: var(--space-2);
}

.mini-track-graph {
    min-height: 300px;
}

/* ===============================
   Plot Containers
================================ */
.chart-surface {
    border-radius: var(--radius-md);
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.028);
    background: var(--color-surface-2);
}

.js-plotly-plot,
.js-plotly-plot .plot-container,
.js-plotly-plot .svg-container {
    border-radius: var(--radius-md) !important;
}

/* ===============================
   Dropdown Styling
================================ */
.Select-control {
    background-color: var(--color-surface-interactive) !important;
    border: 1px solid var(--color-border-subtle) !important;
    border-radius: var(--radius-sm) !important;
    color: var(--color-text-primary) !important;
    box-shadow: none !important;
    transition:
        border-color var(--motion-fast) var(--motion-ease),
        box-shadow var(--motion-fast) var(--motion-ease),
        background-color var(--motion-fast) var(--motion-ease);
}

.Select-control:hover {
    border-color: var(--color-border-strong) !important;
    background-color: #121a27 !important;
}

.Select.is-focused .Select-control,
.Select-control:focus {
    border-color: rgba(255, 24, 1, 0.58) !important;
    box-shadow: 0 0 0 3px rgba(255, 24, 1, 0.16) !important;
    background-color: #121a27 !important;
}

.Select-placeholder,
.Select-value,
.Select-value-label,
.Select-input > input {
    color: var(--color-text-secondary) !important;
}

.Select-input > input {
    outline: none !important;
    box-shadow: none !important;
}

.Select-menu-outer {
    margin-top: var(--space-1);
    border: 1px solid var(--color-border-subtle) !important;
    border-radius: var(--radius-sm) !important;
    overflow: hidden;
    background: var(--color-surface-2) !important;
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.28);
    z-index: 1100 !important;
    animation: selectMenuFade var(--motion-fast) var(--motion-ease);
}

@keyframes selectMenuFade {
    from {
        opacity: 0;
        transform: translateY(-3px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.Select-option {
    border-bottom: 1px solid rgba(255, 255, 255, 0.025);
    background: var(--color-surface-2) !important;
    color: var(--color-text-secondary) !important;
    transition:
        background-color var(--motion-fast) var(--motion-ease),
        color var(--motion-fast) var(--motion-ease);
}

.Select-option.is-focused {
    background: #1a2536 !important;
    color: var(--color-text-primary) !important;
}

.Select-option.is-selected {
    background: rgba(255, 24, 1, 0.18) !important;
    color: #ffd2cd !important;
}

.Select-arrow {
    border-color: var(--color-text-tertiary) transparent transparent !important;
}

.Select--multi .Select-value {
    margin-top: 2px !important;
    margin-right: 4px !important;
    border: 1px solid rgba(255, 24, 1, 0.32) !important;
    border-radius: var(--radius-sm) !important;
    background: rgba(255, 24, 1, 0.12) !important;
    color: #ffd8d3 !important;
    padding: 0 6px !important;
    font-size: 11px !important;
    line-height: 18px !important;
    max-width: 148px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-height: auto !important;
}

.Select--multi .Select-value-icon {
    border-right: 1px solid rgba(255, 24, 1, 0.28) !important;
    color: #ff998f !important;
}

.Select--multi .Select-value-icon:hover {
    background: rgba(255, 24, 1, 0.2) !important;
    color: #ffe2df !important;
}

.Select--multi .Select-value-label {
    display: inline-block;
    max-width: 108px;
    overflow: hidden;
    text-overflow: ellipsis;
    vertical-align: bottom;
}

.control-field--wide .Select-multi-value-wrapper {
    display: block;
    white-space: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
    max-width: calc(100% - 34px);
    scrollbar-width: thin;
}

.control-field--wide .Select-input {
    margin: 0 !important;
    padding: 0 !important;
    min-width: 10px;
}

.control-field--wide .Select-input > input {
    width: 10px !important;
}

/* ===============================
   Table Styling
================================ */
.dash-table-container .dash-spreadsheet-container {
    border-radius: var(--radius-md);
    border: 1px solid rgba(255, 255, 255, 0.04);
    overflow: hidden;
}

.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner {
    border: none;
}

.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner table {
    border-collapse: separate;
    border-spacing: 0;
}

.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner th {
    position: sticky;
    top: 0;
    z-index: 2;
    border-bottom: 1px solid var(--color-border-subtle) !important;
    background: var(--color-surface-3) !important;
    color: var(--color-text-tertiary) !important;
    font-size: 10px !important;
    font-weight: 600 !important;
    letter-spacing: 0.09em;
    text-transform: uppercase;
    height: 30px !important;
}

.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner td {
    border-bottom: 1px solid rgba(255, 255, 255, 0.032) !important;
    color: var(--color-text-secondary) !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    height: 30px !important;
    text-align: right;
    font-variant-numeric: tabular-nums;
}

.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner td:first-child,
.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner th:first-child {
    text-align: left !important;
}

.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner tr:nth-child(even) td {
    background: rgba(255, 255, 255, 0.012) !important;
}

.dash-table-container .dash-spreadsheet-container .dash-spreadsheet-inner tr:hover td {
    background: rgba(255, 255, 255, 0.03) !important;
    color: var(--color-text-primary) !important;
}

/* ===============================
   Slider Styling
================================ */
.slider-shell {
    margin-top: var(--space-2);
}

.lap-stepper {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-3);
}

.lap-nav-btn {
    height: 30px;
    padding: 0 10px;
    border-radius: 7px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(255, 255, 255, 0.03);
    color: var(--color-text-secondary);
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
}

.lap-nav-btn:hover {
    border-color: rgba(255, 24, 1, 0.45);
    color: var(--color-text-primary);
}

.lap-number-input {
    width: 72px;
    height: 30px;
    padding: 0 8px;
    border-radius: 7px;
    border: 1px solid var(--color-border-subtle);
    background: var(--color-surface-interactive);
    color: var(--color-text-primary);
    font-size: 12px;
    font-variant-numeric: tabular-nums;
}

.lap-max-label {
    color: var(--color-text-tertiary);
    font-size: 12px;
    font-variant-numeric: tabular-nums;
}

.lap-context {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    margin-top: var(--space-3);
}

.lap-context-item {
    padding: 5px 9px;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.02);
    color: var(--color-text-secondary);
    font-size: 11px;
    line-height: 1;
    font-variant-numeric: tabular-nums;
}

.lap-context-item--accent {
    border-color: rgba(255, 24, 1, 0.42);
    background: rgba(255, 24, 1, 0.1);
    color: #ffd2cd;
}

.rc-slider-rail {
    height: 6px !important;
    border-radius: 999px;
    background: #2a3547 !important;
}

.rc-slider-track {
    height: 6px !important;
    border-radius: 999px;
    background: var(--color-accent-primary) !important;
}

.rc-slider-handle {
    width: 15px !important;
    height: 15px !important;
    margin-top: -5px !important;
    border: 2px solid #ff6a5c !important;
    background: #1a2434 !important;
    box-shadow: 0 0 0 3px rgba(255, 24, 1, 0.14) !important;
    transition:
        box-shadow var(--motion-fast) var(--motion-ease),
        border-color var(--motion-fast) var(--motion-ease),
        transform var(--motion-fast) var(--motion-ease);
}

.rc-slider-handle:hover,
.rc-slider-handle:focus,
.rc-slider-handle:active,
.rc-slider-handle-dragging {
    border-color: #ff857a !important;
    box-shadow: 0 0 0 4px rgba(255, 24, 1, 0.2) !important;
    transform: scale(1.03);
}

/* ===============================
   Utility
================================ */
#mini-track-map {
    margin-top: 0 !important;
}

.debug-output {
    margin-top: var(--space-5);
    padding: var(--space-3) var(--space-4);
    border-radius: var(--radius-sm);
    border: 1px dashed rgba(147, 161, 181, 0.22);
    background: rgba(255, 255, 255, 0.01);
    color: #7f8ea3;
    font-size: 11px;
    line-height: 1.45;
    white-space: pre-wrap;
}

:focus-visible {
    outline: none;
}

.custom-tab:focus-visible,
.Select-control:focus-visible,
.rc-slider-handle:focus-visible {
    box-shadow: 0 0 0 3px rgba(255, 24, 1, 0.16) !important;
}

/* ===============================
   Responsive
================================ */
@media (max-width: 1200px) {
    :root {
        --topbar-height: 248px;
    }

    .dashboard-topbar {
        grid-template-columns: 1fr;
        gap: var(--space-4);
        height: var(--topbar-height);
    }

    .control-bar {
        grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .dashboard-content {
        padding-top: calc(var(--topbar-height) + var(--space-5));
    }

    .telemetry-grid {
        grid-template-columns: 1fr;
    }

    .delta-grid {
        grid-template-columns: 1fr;
    }

    .metric-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .summary-grid,
    .session-bottom-grid {
        grid-template-columns: 1fr;
    }

    .mini-track-companion {
        position: static;
        max-width: 340px;
    }
}

@media (max-width: 900px) {
    :root {
        --topbar-height: 300px;
    }

    .dashboard-topbar {
        padding: var(--space-3);
    }

    .dashboard-content {
        padding: calc(var(--topbar-height) + var(--space-4)) var(--space-3) var(--space-6);
    }

    .control-bar {
        grid-template-columns: 1fr;
        gap: var(--space-2);
    }

    .custom-tab {
        margin-right: var(--space-4) !important;
    }

    .metric-grid {
        grid-template-columns: 1fr;
    }
}
